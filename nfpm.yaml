# NFPM Configuration for Imbric
# https://nfpm.goreleaser.com/configuration/
#
# Build with: nfpm pkg --packager deb --target dist/

name: "imbric"
arch: "amd64"
platform: "linux"
version: "${VERSION:-0.5.0}"
section: "graphics"
priority: "optional"
maintainer: "Imbric Developers <imbric@example.com>"
description: |
  Photo-first file manager with Masonry layout.
  A modern photo-focused file manager for GNOME with
  a Pinterest-style masonry layout. Built with PySide6 and QML.
vendor: "Imbric"
homepage: "https://github.com/dragon-Elec/Imbric"
license: "MIT"

# Runtime dependencies (Debian package names)
depends:
  - python3 (>= 3.10)
  - python3-pyside6
  - python3-gi
  - gir1.2-gnomedesktop-3.0
  - python3-psutil

recommends:
  - fd-find

# File mappings: src -> dst
contents:
  # Application code
  - src: "core"
    dst: "/usr/lib/imbric/core"
  
  - src: "ui"
    dst: "/usr/lib/imbric/ui"
  
  - src: "main.py"
    dst: "/usr/lib/imbric/main.py"
  
  - src: "qtquickcontrols2.conf"
    dst: "/usr/lib/imbric/qtquickcontrols2.conf"
  
  # Desktop integration
  - src: "ui/imbric.desktop"
    dst: "/usr/share/applications/imbric.desktop"
  
  # Icons (SVG and generated PNG)
  - src: "ui/icon.svg"
    dst: "/usr/share/icons/hicolor/scalable/apps/imbric.svg"
  
  # Launcher script (created below)
  - src: "dist/imbric-launcher"
    dst: "/usr/bin/imbric"
    file_info:
      mode: 0755

# Post-install script to update icon cache
scripts:
  postinstall: |
    #!/bin/sh
    gtk-update-icon-cache -f /usr/share/icons/hicolor 2>/dev/null || true
